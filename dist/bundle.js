!function(t){var s={};function i(e){if(s[e])return s[e].exports;var h=s[e]={i:e,l:!1,exports:{}};return t[e].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=s,i.d=function(t,s,e){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,s){if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var h in t)i.d(e,h,function(s){return t[s]}.bind(null,h));return e},i.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(s,"a",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p="",i(i.s=0)}([function(t,s,i){"use strict";i.r(s);const e="#10203c",h="#ddd",r=64,a=32;const c=document.getElementById("display").getContext("2d");window.chip=new class{constructor(t){this.display=t,this.reset()}load(t,s){for(const i in s)this.Memory[t++]=s[i]}reset(){this.PC=512,this.Stack=[],this.Memory=Array(4096),this.V=Array(15),this.I=0,this.DelayTimer=0,this.SoundTimer=0,this.display.clear(),this.load(0,[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128]),this.load(512,[96,1,97,12,241,41,208,5,99,6,97,8,241,41,211,5])}get state(){return{PC:this.PC,Stack:this.Stack,V:this.V,I:this.I,DelayTimer:this.DelayTimer,SoundTimer:this.SoundTimer}}advanceEmulator(){const t=this.Memory[this.PC]<<8|this.Memory[this.PC+1],s=15&t,i=t>>8&15,e=t>>4&15,h=255&t,r=4095&t;switch(61440&t){case 0:if(224===t)this.display.clear();else{if(238!==t)throw`Invalid opcode: ${this.opcode}`;this.PC=this.Stack.pop()}this.PC+=2;break;case 4096:this.PC=r;break;case 8192:this.Stack.push(this.PC),this.PC=r;break;case 12288:this.PC+=this.V[i]===h?4:2;break;case 16384:this.PC+=this.V[i]===h?2:4;break;case 20480:this.PC+=this.V[i]===this.V[e]?4:2;break;case 24576:this.V[i]=h,this.PC+=2;break;case 28672:this.V[i]=this.V[i]+h,this.PC+=2;break;case 32768:switch(s){case 0:this.V[i]=this.V[e],this.PC+=2;break;case 1:this.V[i]=this.V[i]|this.V[e],this.PC+=2;break;case 2:this.V[i]=this.V[i]&this.V[e],this.PC+=2;break;case 3:this.V[i]=this.V[i]^this.V[e],this.PC+=2;break;case 4:this.V[i]=this.V[i]+this.V[e],this.V[15]=this.V[i]>255?1:0,this.V[i]=255&this.V[i],this.PC+=2;break;case 5:this.V[15]=this.V[e]>this.V[i]?1:0,this.V[i]=this.V[i]-this.V[e],this.PC+=2;break;case 6:this.V[15]=1&this.V[i],this.V[i]=this.V[i]>>1,this.PC+=2;break;case 7:this.V[15]=this.V[e]>this.V[i]?1:0,this.V[i]=this.V[e]-this.V[i],this.PC+=2;break;case 14:this.V[15]=128&this.V[i]?1:0,this.V[i]=this.V[i]<<1,this.PC+=2}break;case 36864:this.PC+=this.V[i]!=this.V[e]?4:2;break;case 40960:this.I=r,this.PC+=2;break;case 45056:this.PC=r+this.V[0];break;case 49152:this.V[i]=Math.floor(255*Math.random())&h,this.PC+=2;break;case 53248:for(let t=0;t<s;t++){let s=this.Memory[this.I+t];for(let h=0;h<8;h++)0!=(s&128>>h)&&this.display.togglePixel(this.V[i]+h,this.V[e]+t)}this.PC+=2;break;case 57344:if(158===h)this.PC+=2;else{if(161!==h)throw`Invalid opcode: ${t}`;this.PC+=4}break;case 61440:switch(h){case 7:this.V[i]=this.DelayTimer,this.PC+=2;break;case 10:throw new`Opcode ${t} not implemented yet`;case 21:this.DelayTimer=this.V[i],this.PC+=2;break;case 24:this.SoundTimer=this.V[i],this.PC+=2;break;case 30:this.I=this.I+this.V[i],this.PC+=2;break;case 41:this.I=5*this.V[i],this.PC+=2;break;case 51:this.Memory[I]=this.V[i]%1e3/100,this.Memory[I+1]=this.V[i]%100/10,this.Memory[I+2]=this.V[i]%10,this.PC+=2;break;case 85:for(let t=0;t<=i;t++)this.Memory[I+t]=this.V[t];this.PC+=2;break;case 101:for(let t=0;t<=i;t++)this.V[t]=this.Memory[I+t];this.PC+=2;break;default:throw new`Invalid opcode: ${t}`}}}updateTimers(){}}(new class{constructor(t){this.ctx=t}clear(){this.ctx.fillStyle=e,this.ctx.fillRect(0,0,r,a)}togglePixel(t,s){this.ctx.fillStyle=h,this.ctx.fillRect(t,s,1,1)}}(c))}]);
//# sourceMappingURL=bundle.js.map